!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){const i=new(n(1));i.injectStyle(),i.checkAuth()},function(t,e,n){const i=n(2),s=n(3);class c{constructor(){this.localStorage=document.body.appendChild(document.createElement("iframe")).contentWindow.localStorage,this.onCooldown=!1,this.GUI=new s(this,this.localStorage)}injectStyle(){const t=document.createElement("style"),e=i.Style;({type:"text/css",style:t,content:e,apply:function(){this.style.type="text/css",this.style.appendChild(document.createTextNode(e)),document.head.appendChild(t)}}).apply()}async checkAuth(t=this.localStorage.token){if(this.localStorage.canCallAPI)return;if("string"!=typeof t)throw new Error("Not a token, buddy.");t=t.replace(/"/gi,""),t=t.replace(/^Bot\s*/i,"");const e=await fetch("https://discordapp.com/api/v7/gateway"),n=await e.json(),i=new WebSocket(`${n.url}/?encoding=json&v6`);i.onerror=(t=>console.error(t)),i.onmessage=(e=>{try{const n=JSON.parse(e.data);this.localStorage.canCallAPI=!0,0===n.op&&"READY"===n.t&&i.close(),10===n.op&&i.send(JSON.stringify({op:2,d:{token:t,properties:{$browser:"b1nzy is a meme"},large_threshold:50}})),console.log("Sucessful authenticated. You can now make REST request!")}catch(t){console.error(t)}})}async sendSticker(t,e,n=this.localStorage.token){if(this.onCooldown)return;this.onCooldown=!0;const i=await fetch(t.file,{cache:"force-cache"}),s=await i.blob(),c=new FormData;c.append("file",s,t.name),n=(n=n.replace(/"/gi,"")).replace(/^Bot\s*/i,""),fetch(`https://discordapp.com/api/channels/${e}/messages`,{headers:{Authorization:n},method:"POST",body:c}),setTimeout(()=>this.onCooldown=!1,1e3)}}t.exports=c},function(t,e){e.Style=`\ndiv#boot-modal { display: none; }\ndiv.channel-textarea-stickers {\n\tposition: absolute;\n\ttop: 12px !important;\n\tright: 45px;\n\tbackground-image: url('/assets/f24711dae4f6d6b28335e866a93e9d9b.png');\n\twidth: 22px;\n\theight: 22px;\n\tbackground-position: -176px -396px;\n\tbackground-size: 924px 704px;\n\tbackground-repeat: no-repeat;\n\ttransition: border-bottom-color .1s ease-in-out;\n\t-webkit-filter: grayscale(100%);\n\tfilter: grayscale(100%);\n\tcursor: pointer;\n}\n\ndiv.channel-textarea-stickers:hover {\n\ttransform: scale(1.275);\n\t-webkit-transform: scale(1.275);\n\tfilter: grayscale(0%);\n\t-webkit-filter: grayscale(0%);\n}\n\ndiv.sticker-selector {\n\tz-index: 2000;\n\tdisplay: none;\n\tbottom: 46px;\n\tright: 0px;\n\twidth: 600px;\n}\n\ndiv.sticker-selector.active { display: block; }\n.sticker-selector .emoji-picker .scroller .row { height: 96px; }\n\n.emoji-picker .scroller .emoji-item.sticker {\n\twidth: 88px;\n\theight: 88px;\n}\n\n.diversity-selector .item.sticker-settings-btn {\n\tbackground-image: url('/assets/f24711dae4f6d6b28335e866a93e9d9b.png');\n\tbackground-position: 0px -330px;\n\tbackground-size: 924px 704px;\n\tpadding: 0px;\n\tmargin-top: 3px;\n}\n\n.kuro-stickers .popout .emoji-picker .scroller-wrap,\n.kuro-stickers .popout .emoji-picker .scroller-wrap .scroller {\n\tmin-height: 400px;\n}\n\n.sticker-container, .config-container {\n\tdisplay: block;\n}\n\n.sticker-container.hidden, .config-container.hidden {\n\tdisplay: none;\n}\n\n.pack-container {\n\tposition: relative;\n\tcursor: pointer;\n}\n\n.pack-container > img {\n\tbackground: #efefef;\n}\n\n.pack-name, .pack-length {\n\tcolor: #98aab6;\n\tfont-size: 12px;\n\tfont-weight: 500;\n\tpadding: 0 4px;\n\ttext-transform: uppercase;\n\tposition: absolute;\n\tleft: 65px;\n\ttop: 14px;\n}\n\n.pack-length {\n\ttop: 27px;\n}\n\n.pack-status.active {\n\tbackground-image: url('/assets/f24711dae4f6d6b28335e866a93e9d9b.png');\n\tbackground-position: -484px -132px;\n\tbackground-size: 924px 704px;\n\tposition: absolute;\n\tright: 12px;\n\ttop: 13px;\n\twidth: 22px;\n\theight: 22px;\n\tmargin: 3px;\n}\n\n.pack-divider {\n\twidth: 50%;\n\theight: 1px;\n\tbackground: #e8e8e8;\n\tmargin-left: 25%;\n\tmargin-top: 10px;\n\tmargin-bottom: 10px;\n}\n`},function(t,e){class n{constructor(t,e){Object.defineProperty(this,"client",{value:t}),this.localStorage=e,this.lastKnownLocation,this.popupWindow,this.appendableElement,this.kuroStickers,this.stickersButton,this.configContainer,this.stickerContainer,this.configButton,this.stickerPacks=[],this.loadTimer=setInterval(async()=>{null!==(document.querySelector('[class^="channelTextArea"] [class^="inner"]')||document.querySelector(".channel-textarea-inner"))&&(clearInterval(this.loadTimer),await this.prepareDOM())})}async processStickers(){const t=await fetch("https://lolisafe.moe/stickers.json"),e=await t.json();this.updateConfigGUI(e)}updateConfigGUI(t){this.localStorage.subscribedPacks||(this.localStorage.subscribedPacks=JSON.stringify([]));const e=JSON.parse(this.localStorage.subscribedPacks);for(const n of t){let i=n.files[0].thumb;i||(i=n.files[0].file);let s="";e.includes(n.name)&&(s=" active");const c=document.createElement("div");c.className="pack-container",c.innerHTML=`\n\t\t\t\t<img src="${i}" style="width: 50px; height: 50px;">\n\t\t\t\t<div class="pack-name">${n.name}</div>\n\t\t\t\t<div class="pack-length">${n.files.length} Stickers</div>\n\t\t\t\t<div class="pack-status ${s}"></div>\n\t\t\t`,c.addEventListener("click",()=>{c.querySelector(".pack-status").classList.toggle("active"),e.includes(n.name)?e.splice(e.indexOf(n.name),1):e.push(n.name),this.localStorage.subscribedPacks=JSON.stringify(e),this.updateStickersGUI(t,e)});const o=document.createElement("div");o.className="pack-divider",this.configContainer.appendChild(c),this.configContainer.appendChild(o),this.updateStickersGUI(t,e)}}updateStickersGUI(t,e){if(this.stickerPacks.length!==t.length){for(;this.stickerContainer.firstChild;)this.stickerContainer.removeChild(this.stickerContainer.firstChild);for(const n of t){if(!e.includes(n.name))continue;this.stickerPacks.push(t);const i=document.createElement("div");i.className="category",i.id=n.name,i.innerText=`${n.name} - ${n.files.length} Stickers`,this.stickerContainer.appendChild(i);for(const t of n.files){let e=t.thumb;e||(e=t.file);const n=document.createElement("div");n.className="emoji-item sticker",n.style.backgroundImage=`url(${e})`,this.stickerContainer.appendChild(n),n.addEventListener("click",async()=>{await this.client.sendSticker(t,window.location.href.split("/").slice(-1)[0]),this.popupWindow.classList.toggle("active")}),n.addEventListener("contextmenu",t=>(t.preventDefault(),!1),!1)}}}}async prepareDOM(){this.kuroStickers=document.createElement("div"),this.kuroStickers.className="kuro-stickers",this.createPopupWindow(),this.stickersButton=document.createElement("div"),this.stickersButton.className="channel-textarea-emoji channel-textarea-stickers",this.stickersButton.addEventListener("click",()=>this.popupWindow.classList.toggle("active")),this.kuroStickers.appendChild(this.stickersButton),this.kuroStickers.appendChild(this.popupWindow),this.configButton=this.kuroStickers.querySelector(".sticker-settings-btn"),this.configButton.classList.toggle("hidden"),this.stickerContainer=this.kuroStickers.querySelector(".sticker-container"),this.configContainer=this.kuroStickers.querySelector(".config-container"),this.configButton.addEventListener("click",()=>this.configContainer.classList.toggle("hidden")),await this.processStickers(),setInterval(()=>{window.location.href!==this.lastKnownLocation&&(this.lastKnownLocation=window.location.href,this.checkDOM())},1e3)}createPopupWindow(){this.popupWindow=document.createElement("div"),this.popupWindow.className="popout popout-top-right no-arrow no-shadow sticker-selector",this.popupWindow.innerHTML=`\n\t\t\t<div class="emoji-picker">\n\t\t\t\t<div class="dimmer"></div>\n\t\t\t\t<div class="header">\n\t\t\t\t\t<div class="search-bar search-bar-light">\n\t\t\t\t\t\t<div class="search-bar-inner">\n\t\t\t\t\t\t\t<input type="text" placeholder="Search stickers" value="" />\n\t\t\t\t\t\t\t<div class="search-bar-icon">\n\t\t\t\t\t\t\t\t<i class="icon icon-search-bar-eye-glass visible"></i>\n\t\t\t\t\t\t\t\t<i class="icon icon-search-bar-clear"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="diversity-selector">\n\t\t\t\t\t\t<div class="item sticker-settings-btn"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="scrollerWrap-2uBjct scroller-wrap scrollerThemed-19vinI themeLight-1WK0Av scrollerFade-28dRsO scrollerTrack-3hhmU0">\n\t\t\t\t\t<div class="scroller-fzNley scroller sticker-container">\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div class="row"></div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroller-fzNley scroller config-container hidden">\n\t\t\t\t\t\t<div class="category">Subscribed sticker pack list</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!--\n\t\t\t\t<div class="categories sticker-packs">\n\t\t\t\t\t<div class="item recent selected"></div>\n\t\t\t\t\t<div class="item custom"></div>\n\t\t\t\t\t<div class="item people"></div>\n\t\t\t\t\t<div class="item nature"></div>\n\t\t\t\t\t<div class="item food"></div>\n\t\t\t\t\t<div class="item activity"></div>\n\t\t\t\t\t<div class="item travel"></div>\n\t\t\t\t\t<div class="item objects"></div>\n\t\t\t\t\t<div class="item symbols"></div>\n\t\t\t\t\t<div class="item flags"></div>\n\t\t\t\t</div>\n\t\t\t\t--\x3e\n\t\t\t</div>\n\t\t`}checkDOM(){this.appendableElement=document.querySelector('[class^="channelTextArea"] [class^="inner"]')||document.querySelector(".channel-textarea-inner"),null!==this.appendableElement&&this.appendableElement.appendChild(this.kuroStickers)}}t.exports=n}]);